# 구글 클라우드 서비스 계정 설정 및 키 다운로드 가이드

이 프로젝트를 실행하기 위해서는 구글 시트/드라이브 API 접근 권한이 있는 **서비스 계정 키(`credentials.json`)**가 필요합니다.

## 1. 구글 클라우드 프로젝트 생성
1. [Google Cloud Console](https://console.cloud.google.com/)에 접속합니다.
2. 좌측 상단의 프로젝트 선택 목록을 클릭하고 **[새 프로젝트]**를 선택합니다.
3. 프로젝트 이름을 입력하고 **[만들기]**를 클릭합니다.

## 2. API 사용 설정
1. 좌측 메뉴에서 **[API 및 서비스]** > **[라이브러리]**로 이동합니다.
2. 검색창에 `Google Sheets API`를 검색하고 **[사용]** 버튼을 클릭합니다.
3. 다시 라이브러리로 돌아와 `Google Drive API`를 검색하고 **[사용]** 버튼을 클릭합니다.
   * (Google Drive API는 시트 접근 권한 관리에 필요할 수 있습니다.)

## 3. 서비스 계정 생성
1. 좌측 메뉴에서 **[API 및 서비스]** > **[사용자 인증 정보]**로 이동합니다.
2. 상단의 **[+ 사용자 인증 정보 만들기]** > **[서비스 계정]**을 선택합니다.
3. **서비스 계정 이름**을 입력합니다 (예: `stock-visualizer`).
4. **[만들기 및 계속]**을 클릭합니다.
5. **역할 선택**에서 **[기본]** > **[편집자]** (또는 소유자)를 선택합니다.
6. **[완료]**를 클릭합니다.

## 4. JSON 키 다운로드 (중요)
1. 생성된 서비스 계정 이메일 주소(예: `stock-visualizer@...iam.gserviceaccount.com`)를 클릭합니다.
2. 상단의 **[키]** 탭을 선택합니다.
3. **[키 추가]** > **[새 키 만들기]**를 클릭합니다.
4. 키 유형으로 **[JSON]**을 선택하고 **[만들기]**를 클릭합니다.
5. **자동으로 다운로드된 JSON 파일**을 찾습니다.

## 5. 프로젝트에 적용
1. 다운로드한 JSON 파일의 이름을 **`credentials.json`**으로 변경합니다.
2. 이 프로젝트의 최상위 폴더(`d:\Github\Kiwoom-Profit-Visualizer`)에 해당 파일을 복사/이동합니다.

## 6. 구글 시트 공유 설정 (선택 사항이지만 권장)
1. 데이터를 저장할 구글 스프레드시트를 만듭니다 (또는 기존 시트 사용).
2. JSON 파일 안에 있는 `client_email` 값(서비스 계정 이메일)을 복사합니다.
3. 구글 시트의 **[공유]** 버튼을 누르고, 해당 이메일을 추가하여 **편집자** 권한을 부여합니다.
   * 이렇게 하면 서비스 계정이 해당 시트에 접근할 수 있게 됩니다.

## 7. 설정 확인
터미널에서 다음 명령어를 실행하여 설정이 올바른지 확인합니다.
```bash
python google_sheet_manager.py --test
```

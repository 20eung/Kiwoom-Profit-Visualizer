# 윈도우 작업 스케줄러 설정 가이드

`run_daily.bat` 파일을 **평일 오전 9시 ~ 오후 4시, 1시간 간격**으로 자동 실행하는 방법입니다.

## 1. 작업 스케줄러 실행
1. 윈도우 시작 버튼 클릭 -> **"작업 스케줄러"** 검색 및 실행

## 2. 작업 만들기
1. 우측 **작업 만들기** 클릭 (기본 작업 만들기 아님)
2. **[일반] 탭**:
    - 이름: `Kiwoom Profit Collector` (원하는 이름)
    - **"가장 높은 수준의 권한으로 실행"** 체크

## 3. 트리거 설정 (핵심)
**[트리거] 탭** -> **새로 만들기**

- **작업 시작**: `예약 상태` 선택
- **설정**: `매주` 선택
- **요일**: `월, 화, 수, 목, 금` 체크
- **시작 시간**: `오전 9:00:00` 설정
- **고급 설정**:
    - **"작업 반복 간격"** 체크 -> `1시간` 선택
    - **"기간"** -> `1일` 선택 (혹은 "무기한" 선택 후, 종료 시간 설정 불가하므로 아래 방식 권장)
    
> **💡 9시~16시 제약 설정 팁 (가장 확실한 방법)**
> 윈도우 스케줄러의 "매시간 반복" 기능은 종료 시간을 정밀하게 제어하기 어렵습니다.
> 따라서 **트리거를 8개 만드는 방식**을 가장 추천합니다.
>
> **이 방식을 쓸 때는 [고급 설정]의 "작업 반복 간격"을 체크하지 마세요!**
> 
> 1. `매주 평일 09:00` (반복 체크 X)
> 2. `매주 평일 10:00` (반복 체크 X)
> ...
> 8. `매주 평일 16:00` (반복 체크 X)
>
> 또는, **"기간"**을 `8시간`(9시부터 8시간 뒤면 17시 종료)으로 수동 입력해도 됩니다.

## 4. 동작 설정
**[동작] 탭** -> **새로 만들기**

- **동작**: `프로그램 시작`
- **프로그램/스크립트**: `찾아보기` -> `D:\Github\Kiwoom-Profit-Visualizer\run_daily.bat` 선택
- **시작 위치(옵션)**: `D:\Github\Kiwoom-Profit-Visualizer\` (⚠️ **매우 중요**: 이 경로를 입력하지 않으면 실행되지 않을 수 있습니다)

## 5. 조건/설정 탭 (선택 사항)
- **[조건] 탭**: "컴퓨터가 AC 전원에서 켜져 있는 경우에만 작업 시작"을 체크 해제하면 노트북 배터리 모드에서도 돕니다.
- **[설정] 탭**: "요청 시 작업을 실행하도록 허용" 체크

## 6. 저장 및 테스트
1. 확인을 눌러 저장합니다. (비밀번호를 물어볼 수 있음)
2. 목록에서 방금 만든 작업을 우클릭 -> **"실행"**을 눌러보세요.
3. 잠시 후 텔레그램 알림이 오는지 확인합니다.
